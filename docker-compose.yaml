version: "3.9"
services:
  redis:
    image: redis:7-alpine
  scd_hub:
    build: ./apps/scd_hub_server
    profiles:
      - sprout
    volumes:
      - ./data:/data
      - ./fonts:/usr/share/fonts/custom
  minihub:
    build: ./apps/minihub
    profiles:
      - sprout
    volumes:
      - ./apps/minihub/resources:/resources
  orchestrator:
    build: ./apps/orchestrator
    env_file: .env
    profiles:
      - sprout
    depends_on:
      - scd_hub
      - minihub
      - redis
    ports:
      - "8000:8000"
  ingestor:
    build: ./apps/ingestor
    profiles:
      - sprout
    volumes:
      - ./data:/data
    entrypoint: ["python","/code/ingest.py"]
  line_bot:
    build: ./apps/bots/line_bot
    profiles:
      - sprout
  slack_bot:
    build: ./apps/bots/slack_bot
    profiles:
      - sprout
